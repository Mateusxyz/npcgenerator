<link rel="stylesheet" href="http://127.0.0.1:8080/css/card.css">
<!--
Create attributes array, randomly generates a value
-->
<%
 let attribute_value = {}
 let attributes = [
    'INT',
    'REF',
    'DEX',
    'TECH',
    'COOL',
    'WILL',
    'LUCK',
    'MOVE',
    'BODY',
    'EMP'
]
attributes.forEach(attribute => {
    attribute_value[attribute] = Math.floor(Math.random() * (5   - 1) + 2)
});
%>
<!--
Create weapons array, randomly   generates a weapon for the character
-->
<%
let weapons = [
  {
    pistol: [
      {
        "Medium Pistol": {
          damage: "2d6",
          magazine: 12
        }
      },
      {
        "Heavy Pistol": {
          damage: "3d6",
          magazine: 8
        }
      },
      {
        "Very Heavy Pistol": {
          damage: "4d6",
          magazine: 8
        }
      }
    ]
  },
  {
    smg: [
      {
        "SMG": {
          damage: "2d6",
          magazine: 30
        }
      },
      {
        "Heavy SMG": {
          damage: "3d6",
          magazine: 40
        }
      }
    ]
  }
];

let weaponTypeRandom = Math.floor(Math.random() * weapons.length)
let selectedWeaponType = weapons[weaponTypeRandom]
let selectedWeaponTypeName = Object.keys(selectedWeaponType)

let weaponRandom = Math.floor(Math.random() * selectedWeaponType[selectedWeaponTypeName].length)
let selectedWeapon = selectedWeaponType[selectedWeaponTypeName][weaponRandom]
let selectedWeaponName = Object.keys(selectedWeapon)

let magazine = selectedWeapon[selectedWeaponName].magazine
let damage = selectedWeapon[selectedWeaponName].damage  
%>

<div class="card">
    <div class="info">

    </div>
    <div class="stats">
        <!--
        Render all attributes with random values
        -->
        <div class="attributes">
            <% attributes.forEach(function(attribute) { %>
            <span class="attributes-item"><%= attribute%>: <%= attribute_value[attribute]; %></span>
            <% }) %>
        </div>
        <!--
        Calculates the hitpoints 
        -->
        <% 
        let will = attribute_value.WILL
        let body = attribute_value.BODY
        let TotalHitPoints = Math.ceil(10 + (5 * Math.round((will+body) / 2)))
        %>  
        <!--
        Calculates seriously wounded and death save
        -->
        <% 
        let SeriouslyWounded = Math.round(TotalHitPoints / 2)
        %>
        <div class="health">
            <span>Hit Points: <%= TotalHitPoints %></span>
            <span>Seriously Wounded: <%= SeriouslyWounded %></span>
            <span>Death Save: <%= body %></span>
        </div>
    </div>
    <div class="weapons">
        <%=selectedWeaponName[0]+" "%> <button>  <%=damage%>  </button> <%=" "+magazine%> 
    </div>
    <div class="skills"></div>
</div>   
    




